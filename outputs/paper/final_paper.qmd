---
title: " "
author: "Myra Li"
date: "19 April 2023"
date-format: long
abstract: ""
format: pdf
documentclass: article
geometry: margin = 1in 
bibliography: references.bib
---


# Introduction
The pervasive presence of plastics in the marine environment has been a significant concern since the 1970s, with their detrimental effects on ecosystems and wildlife becoming increasingly apparent [@PlasticParticles]. Despite growing awareness, a considerable number of individuals remain uninformed about the severity of this issue, leading to continued dependence on single-use plastic products. The overuse of plastics contributes to problems such as the accumulation of microplastics, the entanglement and ingestion of plastic debris by marine life, and the leaching of hazardous chemicals into the environment. These issues have far-reaching consequences for biodiversity and human health.
                            
Given the seriousness of plastic pollution, governments are increasingly seeking ways to protect the environment through legislation. It is essential to understand people's opinions on laws aimed at reducing single-use eating utensil consumption and identify which demographic groups may be less likely to support these measures. This knowledge will enable policymakers to tailor their decisions and campaigns accordingly.
                        
In this study, we apply a logistic regression model to explore the relationship between demographic factors and an individual's stance on a by-request/ask-first bylaw aimed at reducing single-use eating utensil consumption in the City of Toronto. By examining these factors, we can better comprehend public receptiveness to such a bylaw and devise targeted strategies to raise awareness and encourage behavioral changes that ultimately help mitigate the adverse effects of plastic pollution on our environment.
                         
In our study, we focused on five primary demographic factors: 1) gender, 2) age, 3) education level, and 4) household income. We hypothesized that factors such as education level, age, and household income would have a more significant impact on individuals' opinions regarding the reduction of single-use eating utensils, while other features, such as gender would have a lesser impact.
                               
To provide readers with the necessary background information, the data section outlines the data collection methodology, along with visualizations and insights derived from analyzing the data. In the model section, we employ a logistic regression model to elucidate the relationship between demographic factors and an individual's stance on a by-request/ask-first bylaw. The results section provides a summary of our findings and outlines plans for further exploration.
                        

# Data {#sec-data}
## Data Source and Collection
Our study utilizes data obtained from Open Data Toronto, specifically from Solid Waste Management Services. The data was collected through online surveys conducted in two phases: one in fall 2018 and another in fall 2019. For our analysis, we used the raw data from the fall 2019 survey.
                       
The dataset comprises responses from both the public survey and independent polling. The public online survey was available from September 24, 2019, to November 11, 2019, garnering approximately 23,700 responses. In addition, an independent polling sample of 1,000 Toronto residents aged 16 or older was surveyed online between November 26 and December 3, 2019.
                              
We obtained the dataset from OpenDataToronto [@citeODT]. This analysis will be performed in R [@R], using the tidyverse @R-tidyverse, dplyr [@dplyr], tidyr [@R-tidyr], haven [@haven], readr [@R-readr], knitr [@R-knitr]. All tables in the report are generated by , and kableExtra [@R-kableExtra]. All figures in the report are generated using ggplot2 [@ggplot].And we used modelsummary [@R-modelsummary], nnet [@R-nnet] for the model analyzing.


## Strength and Weakness of Dataset
The strength of this online survey lies in its inclusiveness, as it is open to all interested stakeholders, enabling a diverse range of opinions to be gathered. Moreover, the survey benefits from a relatively large sample size, which enhances the statistical power and generalizability of the findings.
                                  
However, the survey also has some inherent weaknesses. One notable limitation is that it primarily attracts participants who are interested in the subject matter. Consequently, the respondents are more likely to be environmentally conscious individuals who are already concerned about pollution. This inherent bias in the participant pool may skew the data towards more positive responses, as those who are less concerned about pollution or do not view the issue as a priority may be underrepresented in the survey results. This potential bias should be taken into account when interpreting the findings and drawing conclusions based on the survey data. Further research, employing alternative sampling methods to reach a more diverse and representative audience, could help overcome this limitation and provide a more comprehensive understanding of public opinion on the by-request/ask-first bylaw.


## Variables
We selected five variables from the raw data for our analysis, as detailed below:
                                       
Support for Bylaw: The respondents' level of support or opposition to a by-request/ask-first bylaw aimed at reducing single-use eating utensil consumption in the City of Toronto. The available response options include: Strongly support, Somewhat support, Neither support nor oppose, Somewhat oppose, Strongly oppose, and Don't know.
                                
Gender: The respondents' gender, with available response options being Male and Female.
                                 
Age: The age of the respondents, recorded in numerical format.
                              
Education: The highest level of education achieved by the respondents. Response options include: Graduated from college/CEGEP/Trade School, Graduated high school, Primary school or less, Some college/CEGEP/Trade School, Some high school, Some university but did not finish, University graduate degree, and University undergraduate degree.
                           
Household Income: The respondents' household income, with response options ranging from "Less than $5,000" to "$250,000 or more" in various increments, as well as "Prefer not to answer."
                         
                    
## Data Visualization

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(fig.width=6.5, fig.height=2.8) 
# loading in relevant libraries
library(opendatatoronto)
library(tidyverse)
library(dplyr, warn.conflicts = FALSE)
library(tidyr)
library(haven)
library(ggplot2)
library(nnet)
library(readr)
library(knitr)
library(kableExtra)
library(modelsummary)        

### Input data ###
raw_data <- read.csv(here::here("outputs/data/cleaned_data.csv"))

```


```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-1gender
#| fig-cap: "Opinions on Single-Use Utensil Bylaw by Gender"
# Subset the data frame to include only the necessary columns
gender <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "gender"))

# Define the order of the opinion categories
opinion_order <- c("Strongly support", "Somewhat support", "Neither support nor oppose", 
                   "Somewhat oppose", "Strongly oppose", "Don't know")

# Convert the opinion column to a factor with the desired order
gender$single_use_utensil_bylaw_opinion <- factor(gender$single_use_utensil_bylaw_opinion, levels = opinion_order)

# Generate a bar plot with gender on the x axis and count on the y axis
ggplot(gender, aes(x = single_use_utensil_bylaw_opinion, fill = gender)) +
  geom_bar(position = position_dodge()) +
  labs(
       x = "Opinion", y = "Count") +
  scale_fill_manual(values = c("#E69F00", "#56B4E9"), labels = c("Male", "Female")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
@fig-1gender illustrates a subtle difference between genders regarding opinions on the single-use utensil bylaw. While the discrepancy is not substantial, females generally exhibit less support for the laws aimed at reducing single-use utensil consumption. It is essential to acknowledge that the available response options for gender are limited to female and male, which may not accurately represent the inclusivity and diversity of gender identities. Furthermore, the survey does not explicitly specify whether the gender options refer to biological sex or gender identity, which could potentially influence the interpretation of the results.

In light of these limitations, it is crucial to consider the potential impact of a more inclusive and comprehensive approach to capturing gender information in future surveys. By offering a wider range of gender options, including non-binary and transgender identities, as well as clearly defining whether the question pertains to biological sex or gender identity, researchers can obtain a more accurate and nuanced understanding of the relationship between gender and opinions on the single-use utensil bylaw. This, in turn, could help policymakers and environmental advocates tailor their campaigns and communication strategies to engage different segments of the population more effectively and foster greater support for such environmental initiatives.

```{r, fig.height = 4.5}
#| message: false
#| warning: false
#| echo: false
#| label: fig-2age
#| fig-cap: "Opinions on Single-Use Utensil Bylaw by Age"
# Subset the data frame to include only the necessary columns
age <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "age"))

# Define the order of the opinion categories
opinion_order <- c("Strongly support", "Somewhat support", "Neither support nor oppose", 
                   "Somewhat oppose", "Strongly oppose", "Don't know")

# Convert the opinion column to a factor with the desired order
age$single_use_utensil_bylaw_opinion <- factor(age$single_use_utensil_bylaw_opinion, levels = opinion_order)

# Generate a line graph with age on the x axis and count on the y axis, colored by opinion
ggplot(age, aes(x = age, y = ..count.., group = single_use_utensil_bylaw_opinion, color = single_use_utensil_bylaw_opinion)) +
  geom_line(stat = "bin", bins = 10) +
  labs(
       x = "Age", y = "Count", color = "Opinion") +
  scale_color_manual(values = c("#F8766D", "#00BFC4", "#7CAE00", "#E69F00", "#0072B2", "#D8C400")) 

```
@fig-2age reveals that the majority of respondents fall within the age brackets of around 30 and around 60 years old. Among these individuals, many express moderate support for the bylaw. A substantial portion of respondents strongly support the bylaw, while a smaller group somewhat supports it. In most cases, across different age groups, the pattern of choices appears to be similar.
                                          
However, we also observed an interesting trend among individuals aged 50-60 years old: there is an upward tendency for them to choose "somewhat oppose." This trend may suggest that people in this age group might hold more conservative views or have specific concerns that influence their stance on the bylaw. To better understand the underlying reasons for this divergence in opinions, further research could be conducted to explore the factors that contribute to this particular age group's less supportive outlook on the single-use utensil bylaw.
                                         
In summary, while the overall trend of support for the bylaw is consistent across most age groups, the notable exception of those aged 50-60 warrants further investigation. By examining the unique perspectives and concerns of individuals within this age bracket, policymakers and environmental advocates can better tailor their messaging and strategies to address potential reservations, ultimately fostering broader support for the bylaw among various age groups.                        
```{r, fig.height = 4.5}
#| message: false
#| warning: false
#| echo: false
#| label: fig-3
#| fig-cap: "Opinions on Single-Use Utensil Bylaw Among University Undergraduate Degree Holders"
# Subset the data frame to include only the necessary columns
subset_data <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "education"))

# Filter the data frame for responses with "University undergraduate degree"
university_data <- subset_data %>% 
  filter(education == "University undergraduate degree")

# Count the number of responses for each opinion level
opinion_counts <- count(university_data, single_use_utensil_bylaw_opinion)

# Calculate the total number of responses
total_responses <- sum(opinion_counts$n)

# Calculate the percentage of respondents for each opinion level
percentages <- opinion_counts$n / total_responses * 100

# Combine the counts and percentages into a data frame
result <- data.frame(opinion = opinion_counts$single_use_utensil_bylaw_opinion, count = opinion_counts$n, percentage = percentages)

# Generate the grouped bar chart
ggplot(result, aes(x = opinion, y = percentage, fill = opinion)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  labs(
      y = "Percentage", fill = "Opinion") +
  scale_fill_manual(values = c("#F0E442", "#0072B2", "#D55E00", "#009E73", "#F8766D", "#00BFC4", "#7CAE00", "#C77CFF")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
```{r, fig.height = 4.5}
#| message: false
#| warning: false
#| echo: false
#| label: fig-4
#| fig-cap: "Opinions on Single-Use Utensil Bylaw Among University graduate degree Holders"
# Subset the data frame to include only the necessary columns
subset_data <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "education"))

# Filter the data frame for responses with "University graduate degree"
university_data <- subset_data %>% 
  filter(education == "University graduate degree")

# Count the number of responses for each opinion level
opinion_counts <- count(university_data, single_use_utensil_bylaw_opinion)

# Calculate the total number of responses
total_responses <- sum(opinion_counts$n)

# Calculate the percentage of respondents for each opinion level
percentages <- opinion_counts$n / total_responses * 100

# Combine the counts and percentages into a data frame
result <- data.frame(opinion = opinion_counts$single_use_utensil_bylaw_opinion, count = opinion_counts$n, percentage = percentages)

# Generate the grouped bar chart
ggplot(result, aes(x = opinion, y = percentage, fill = opinion)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  labs(
      y = "Percentage", fill = "Opinion") +
  scale_fill_manual(values = c("#F0E442", "#0072B2", "#D55E00", "#009E73", "#F8766D", "#00BFC4", "#7CAE00", "#C77CFF")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r, fig.height = 4.5}
#| message: false
#| warning: false
#| echo: false
#| label: fig-5
#| fig-cap: "Opinions on Single-Use Utensil Bylaw Among people who completed Some university, but did not finish"
# Subset the data frame to include only the necessary columns
subset_data <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "education"))

# Filter the data frame for responses with "Some university, but did not finish"
university_data <- subset_data %>% 
  filter(education == "Some university, but did not finish")

# Count the number of responses for each opinion level
opinion_counts <- count(university_data, single_use_utensil_bylaw_opinion)

# Calculate the total number of responses
total_responses <- sum(opinion_counts$n)

# Calculate the percentage of respondents for each opinion level
percentages <- opinion_counts$n / total_responses * 100

# Combine the counts and percentages into a data frame
result <- data.frame(opinion = opinion_counts$single_use_utensil_bylaw_opinion, count = opinion_counts$n, percentage = percentages)

# Generate the grouped bar chart
ggplot(result, aes(x = opinion, y = percentage, fill = opinion)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  labs(
      y = "Percentage", fill = "Opinion") +
  scale_fill_manual(values = c("#F0E442", "#0072B2", "#D55E00", "#009E73", "#F8766D", "#00BFC4", "#7CAE00", "#C77CFF")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-6
#| fig-cap: "Opinions on Single-Use Utensil Bylaw Among people who completed Some high school"
# Subset the data frame to include only the necessary columns
subset_data <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "education"))

# Filter the data frame for responses with "Some high school"
university_data <- subset_data %>% 
  filter(education == "Some high school")

# Count the number of responses for each opinion level
opinion_counts <- count(university_data, single_use_utensil_bylaw_opinion)

# Calculate the total number of responses
total_responses <- sum(opinion_counts$n)

# Calculate the percentage of respondents for each opinion level
percentages <- opinion_counts$n / total_responses * 100

# Combine the counts and percentages into a data frame
result <- data.frame(opinion = opinion_counts$single_use_utensil_bylaw_opinion, count = opinion_counts$n, percentage = percentages)

# Generate the grouped bar chart
ggplot(result, aes(x = opinion, y = percentage, fill = opinion)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  labs(
      y = "Percentage", fill = "Opinion") +
  scale_fill_manual(values = c("#F0E442", "#0072B2", "#D55E00", "#009E73", "#F8766D", "#00BFC4", "#7CAE00", "#C77CFF")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

```{r, fig.height = 4.5}
#| message: false
#| warning: false
#| echo: false
#| label: fig-7
#| fig-cap: "Opinions on Single-Use Utensil Bylaw Among people who completed Some college / CEGEP / Trade School"
# Subset the data frame to include only the necessary columns
subset_data <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "education"))

# Filter the data frame for responses with "Some college / CEGEP / Trade School"
university_data <- subset_data %>% 
  filter(education == "Some college / CEGEP / Trade School")

# Count the number of responses for each opinion level
opinion_counts <- count(university_data, single_use_utensil_bylaw_opinion)

# Calculate the total number of responses
total_responses <- sum(opinion_counts$n)

# Calculate the percentage of respondents for each opinion level
percentages <- opinion_counts$n / total_responses * 100

# Combine the counts and percentages into a data frame
result <- data.frame(opinion = opinion_counts$single_use_utensil_bylaw_opinion, count = opinion_counts$n, percentage = percentages)

# Generate the grouped bar chart
ggplot(result, aes(x = opinion, y = percentage, fill = opinion)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  labs(
      y = "Percentage", fill = "Opinion") +
  scale_fill_manual(values = c("#F0E442", "#0072B2", "#D55E00", "#009E73", "#F8766D", "#00BFC4", "#7CAE00", "#C77CFF")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
```{r, fig.height = 4.5}
#| message: false
#| warning: false
#| echo: false
#| label: fig-8
#| fig-cap: "Opinions on Single-Use Utensil Bylaw Among people who completed Primary school or less"
# Subset the data frame to include only the necessary columns
subset_data <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "education"))

# Filter the data frame for responses with "Primary school or less"
university_data <- subset_data %>% 
  filter(education == "Primary school or less")

# Count the number of responses for each opinion level
opinion_counts <- count(university_data, single_use_utensil_bylaw_opinion)

# Calculate the total number of responses
total_responses <- sum(opinion_counts$n)

# Calculate the percentage of respondents for each opinion level
percentages <- opinion_counts$n / total_responses * 100

# Combine the counts and percentages into a data frame
result <- data.frame(opinion = opinion_counts$single_use_utensil_bylaw_opinion, count = opinion_counts$n, percentage = percentages)

# Generate the grouped bar chart
ggplot(result, aes(x = opinion, y = percentage, fill = opinion)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  labs(
      y = "Percentage", fill = "Opinion") +
  scale_fill_manual(values = c("#F0E442", "#0072B2", "#D55E00", "#009E73", "#F8766D", "#00BFC4", "#7CAE00", "#C77CFF")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


```{r, fig.height = 4.5}
#| message: false
#| warning: false
#| echo: false
#| label: fig-9
#| fig-cap: "Opinions on Single-Use Utensil Bylaw Among people who graduated high school"
# Subset the data frame to include only the necessary columns
subset_data <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "education"))

# Filter the data frame for responses with "Graduated high school"
university_data <- subset_data %>% 
  filter(education == "Graduated high school")

# Count the number of responses for each opinion level
opinion_counts <- count(university_data, single_use_utensil_bylaw_opinion)

# Calculate the total number of responses
total_responses <- sum(opinion_counts$n)

# Calculate the percentage of respondents for each opinion level
percentages <- opinion_counts$n / total_responses * 100

# Combine the counts and percentages into a data frame
result <- data.frame(opinion = opinion_counts$single_use_utensil_bylaw_opinion, count = opinion_counts$n, percentage = percentages)

# Generate the grouped bar chart
ggplot(result, aes(x = opinion, y = percentage, fill = opinion)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  labs(
      y = "Percentage", fill = "Opinion") +
  scale_fill_manual(values = c("#F0E442", "#0072B2", "#D55E00", "#009E73", "#F8766D", "#00BFC4", "#7CAE00", "#C77CFF")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
```{r, fig.height = 4.5}
#| message: false
#| warning: false
#| echo: false
#| label: fig-10
#| fig-cap: "Opinions on Single-Use Utensil Bylaw Among people who Graduated from college / CEGEP / Trade School"
# Subset the data frame to include only the necessary columns
subset_data <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "education"))

# Filter the data frame for responses with "Graduated from college / CEGEP / Trade School"
university_data <- subset_data %>% 
  filter(education == "Graduated from college / CEGEP / Trade School")

# Count the number of responses for each opinion level
opinion_counts <- count(university_data, single_use_utensil_bylaw_opinion)

# Calculate the total number of responses
total_responses <- sum(opinion_counts$n)

# Calculate the percentage of respondents for each opinion level
percentages <- opinion_counts$n / total_responses * 100

# Combine the counts and percentages into a data frame
result <- data.frame(opinion = opinion_counts$single_use_utensil_bylaw_opinion, count = opinion_counts$n, percentage = percentages)

# Generate the grouped bar chart
ggplot(result, aes(x = opinion, y = percentage, fill = opinion)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  labs(
      y = "Percentage", fill = "Opinion") +
  scale_fill_manual(values = c("#F0E442", "#0072B2", "#D55E00", "#009E73", "#F8766D", "#00BFC4", "#7CAE00", "#C77CFF")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
                                                                                
Next, we conducted an analysis for each opinion on the single-use utensil bylaw, examining whether the respondents' education level had an impact on their opinion. As @fig-3 demonstrates, the majority of university undergraduate degree holders either strongly or somewhat support the single-use utensil bylaw. Similarly, @fig-4 shows that university graduate degree holders also overwhelmingly support the bylaw, with more than 70% of respondents either strongly or somewhat supporting it.
                                           
However, for those who completed some university education but did not finish (@fig-5), the proportion of respondents who neither support nor oppose the bylaw increased. This trend is even more pronounced for those who completed only some high school (@fig-6), with a significant increase in the "neither support nor oppose" category and about 10% of respondents choosing "don't know." Interestingly, no respondents in these groups strongly opposed the bylaw, and fewer than 10% somewhat opposed it. This finding suggests that interventions or educational efforts may sway those who are undecided to support the bylaw.
                                     
@fig-7 shows that individuals who completed some college, CEGEP, or trade school had similar trends as university undergraduate and graduate degree holders. This observation indicates that those who completed education beyond high school are generally more supportive of the single-use utensil bylaw. In contrast, Figure 8, which represents respondents who completed primary school or less, reveals a 100% "neither support nor oppose" response. However, this result may not be particularly informative due to the small number of respondents in this category.
                                    
We also noted that for each education level, approximately 10% of respondents chose "neither support nor oppose." It may be easier to persuade these individuals to support the bylaw than to change the minds of those who already oppose it.    

```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-11
#| fig-cap: "Strongly Support Opinions on Single-Use Utensil Bylaw by Household Income"
# Subset the data frame to include only the necessary columns and select only "Strongly support" opinions
income <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "household_income"))
income <- subset(income, single_use_utensil_bylaw_opinion == "Strongly support")

# Convert the opinion column to a factor with the desired order
income$single_use_utensil_bylaw_opinion <- factor(income$single_use_utensil_bylaw_opinion, levels = opinion_order)

# Define the order of the income categories
income_order <- c("Less than $5,000", "$5,000-$9,999", "$10,000-$14,999", "$15,000-$19,999", "$20,000-$24,999", "$25,000-$29,999", "$30,000-$34,999", "$35,000-$39,999", "$40,000-$44,999", "$45,000-$49,999", "$50,000-$54,999", "$55,000-$59,999", "$60,000-$64,999", "$65,000-$69,999", "$70,000-$74,999","$75,000-$79,999", "$80,000-$84,999", "$85,000-$89,999", "$90,000-$94,999", "$95,000-$99,999", "$100,000-$124,999", "$125,000-$149,999", "$150,000-$199,999", "$200,000-$249,000", "$250,000 or more", "Prefer not to answer")

# Convert the income column to a factor with the desired order
income$household_income <- factor(income$household_income, levels = income_order)

# Generate a bar chart with household_income on the x axis and count on the y axis, colored by opinion
ggplot(income, aes(x = household_income, y = ..count.., fill = single_use_utensil_bylaw_opinion)) +
  geom_bar(stat = "count", position = "dodge") +
  labs(
       x = "Household Income", y = "Count", fill = "Opinion") +
  scale_fill_manual(values = c("#F8766D")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
                                    
We proceeded to investigate the association between household income and opinions on the single-use utensil bylaw by analyzing the distribution of household income across each opinion category. Our findings revealed intriguing trends, as illustrated in @fig-11. The data indicates that individuals with higher household incomes are generally more likely to strongly support the single-use utensil bylaw. However, when it comes to respondents with a household income of 250,000 cad or more, the number of those who strongly support the bylaw sees a decline.
                                      
This decline among the highest income group may be attributed to various factors, such as the perception that the bylaw might not directly impact their lifestyle or a lack of awareness about the severity of plastic pollution. It is also possible that these individuals have different environmental priorities or believe that other measures would be more effective in addressing the issue.
                                            
To address this gap in support, targeted communication and educational campaigns could be designed to emphasize the importance of reducing single-use plastics and the wider environmental benefits of adopting sustainable practices. For instance, appealing to the sense of social responsibility among this income group or highlighting the potential long-term savings associated with reusable alternatives could be effective strategies.
                                                
    
```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-12
#| fig-cap: "Somewhat Support Opinions on Single-Use Utensil Bylaw by Household Income"
# Subset the data frame to include only the necessary columns and select only "Somewhat support" opinions
income <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "household_income"))
income <- subset(income, single_use_utensil_bylaw_opinion == "Somewhat support")

# Convert the opinion column to a factor with the desired order
income$single_use_utensil_bylaw_opinion <- factor(income$single_use_utensil_bylaw_opinion, levels = opinion_order)

# Define the order of the income categories
income_order <- c("Less than $5,000", "$5,000-$9,999", "$10,000-$14,999", "$15,000-$19,999", "$20,000-$24,999", "$25,000-$29,999", "$30,000-$34,999", "$35,000-$39,999", "$40,000-$44,999", "$45,000-$49,999", "$50,000-$54,999", "$55,000-$59,999", "$60,000-$64,999", "$65,000-$69,999", "$70,000-$74,999","$75,000-$79,999", "$80,000-$84,999", "$85,000-$89,999", "$90,000-$94,999", "$95,000-$99,999", "$100,000-$124,999", "$125,000-$149,999", "$150,000-$199,999", "$200,000-$249,000", "$250,000 or more", "Prefer not to answer")

# Convert the income column to a factor with the desired order
income$household_income <- factor(income$household_income, levels = income_order)

# Generate a bar chart with household_income on the x axis and count on the y axis, colored by opinion
ggplot(income, aes(x = household_income, y = ..count.., fill = single_use_utensil_bylaw_opinion)) +
  geom_bar(stat = "count", position = "dodge") +
  labs(
       x = "Household Income", y = "Count", fill = "Opinion") +
  scale_fill_manual(values = c("#F8766D")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
                                                      
From @fig-12, we found that for those who somewhat support the bylaw, a large portion of respondents had a household income ranging from 100,000 cad to 124,999 cad. However, as the household income rose above this range, the number of people who somewhat supported the bylaw decreased.
                                       
Furthermore, we observed that individuals with a household income of 250,000 or more cad, as well as those with a household income of less than 10,000 cad, were the least likely to somewhat support the bylaw. This finding suggests that opinions on the bylaw may be influenced by socioeconomic factors. Individuals with higher incomes might have different priorities or concerns, while those with lower incomes might face more pressing financial challenges that overshadow environmental issues.
                                          
```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-13
#| fig-cap: "Neither Support Nor Oppose Opinions on Single-Use Utensil Bylaw by Household Income"
# Subset the data frame to include only the necessary columns and select only "Neither support nor oppose" opinions
income <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "household_income"))
income <- subset(income, single_use_utensil_bylaw_opinion == "Neither support nor oppose")

# Convert the opinion column to a factor with the desired order
income$single_use_utensil_bylaw_opinion <- factor(income$single_use_utensil_bylaw_opinion, levels = opinion_order)

# Define the order of the income categories
income_order <- c("Less than $5,000", "$5,000-$9,999", "$10,000-$14,999", "$15,000-$19,999", "$20,000-$24,999", "$25,000-$29,999", "$30,000-$34,999", "$35,000-$39,999", "$40,000-$44,999", "$45,000-$49,999", "$50,000-$54,999", "$55,000-$59,999", "$60,000-$64,999", "$65,000-$69,999", "$70,000-$74,999","$75,000-$79,999", "$80,000-$84,999", "$85,000-$89,999", "$90,000-$94,999", "$95,000-$99,999", "$100,000-$124,999", "$125,000-$149,999", "$150,000-$199,999", "$200,000-$249,000", "$250,000 or more", "Prefer not to answer")

# Convert the income column to a factor with the desired order
income$household_income <- factor(income$household_income, levels = income_order)

# Generate a bar chart with household_income on the x axis and count on the y axis, colored by opinion
ggplot(income, aes(x = household_income, y = ..count.., fill = single_use_utensil_bylaw_opinion)) +
  geom_bar(stat = "count", position = "dodge") +
  labs( 
       x = "Household Income", y = "Count", fill = "Opinion") +
  scale_fill_manual(values = c("#F8766D")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
In our analysis of individuals who hold a neutral stance, neither supporting nor opposing the single-use utensil bylaw, we discovered that a significant number of respondents prefer not to disclose their household income (@fig-13). Among those who did provide information about their household income, it appears that a higher proportion of people with lower incomes tend to adopt the "neither support nor oppose" viewpoint.
                                       
This trend may be attributed to several factors. People with lower household incomes might not prioritize environmental issues due to more pressing concerns, such as financial stability and meeting basic needs. Additionally, they may lack access to resources and information that could raise awareness about the detrimental effects of single-use plastics and the importance of reducing their consumption.
                                        
To engage this demographic and encourage them to support the bylaw, it may be beneficial to implement targeted educational and awareness campaigns. These initiatives could emphasize the potential cost savings associated with reusable utensils, as well as the positive environmental impact of reducing single-use plastics. By making the connection between personal financial benefits and environmental stewardship, it may be possible to sway the opinions of those who are currently neutral on the issue.
                                  
```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-14
#| fig-cap: "Somewhat Oppose Opinions on Single-Use Utensil Bylaw by Household Income"
# Subset the data frame to include only the necessary columns and select only "Somewhat oppose" opinions
income <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "household_income"))
income <- subset(income, single_use_utensil_bylaw_opinion == "Somewhat oppose")

# Convert the opinion column to a factor with the desired order
income$single_use_utensil_bylaw_opinion <- factor(income$single_use_utensil_bylaw_opinion, levels = opinion_order)

# Define the order of the income categories
income_order <- c("Less than $5,000", "$5,000-$9,999", "$10,000-$14,999", "$15,000-$19,999", "$20,000-$24,999", "$25,000-$29,999", "$30,000-$34,999", "$35,000-$39,999", "$40,000-$44,999", "$45,000-$49,999", "$50,000-$54,999", "$55,000-$59,999", "$60,000-$64,999", "$65,000-$69,999", "$70,000-$74,999","$75,000-$79,999", "$80,000-$84,999", "$85,000-$89,999", "$90,000-$94,999", "$95,000-$99,999", "$100,000-$124,999", "$125,000-$149,999", "$150,000-$199,999", "$200,000-$249,000", "$250,000 or more", "Prefer not to answer")

# Convert the income column to a factor with the desired order
income$household_income <- factor(income$household_income, levels = income_order)

# Generate a bar chart with household_income on the x axis and count on the y axis, colored by opinion
ggplot(income, aes(x = household_income, y = ..count.., fill = single_use_utensil_bylaw_opinion)) +
  geom_bar(stat = "count", position = "dodge") +
  labs(title = "Somewhat Oppose Opinions on Single-Use Utensil Bylaw by Household Income", 
       x = "Household Income", y = "Count", fill = "Opinion") +
  scale_fill_manual(values = c("#F8766D")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
An intriguing observation we made in our analysis is that no respondents with a household income higher than 199,999 cad expressed somewhat opposing views on the single-use utensil bylaw. Additionally, we found that a substantial proportion of individuals with household incomes ranging from 125,000 cad to 199,999 cad tended to somewhat oppose the bylaw.

This pattern may be attributed to various factors that are unique to this income bracket. Individuals within this income range may have different consumption patterns or lifestyle choices that make the transition to reusable utensils more challenging or less appealing. Alternatively, they may perceive the bylaw as an unnecessary restriction on their personal freedoms or have concerns about the practicality and effectiveness of the proposed measures.
                             


```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-15
#| fig-cap: "Strongly Oppose Opinions on Single-Use Utensil Bylaw by Household Income"
# Subset the data frame to include only the necessary columns and select only "Strongly oppose" opinions
income <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "household_income"))
income <- subset(income, single_use_utensil_bylaw_opinion == "Strongly oppose")

# Convert the opinion column to a factor with the desired order
income$single_use_utensil_bylaw_opinion <- factor(income$single_use_utensil_bylaw_opinion, levels = opinion_order)

# Define the order of the income categories
income_order <- c("Less than $5,000", "$5,000-$9,999", "$10,000-$14,999", "$15,000-$19,999", "$20,000-$24,999", "$25,000-$29,999", "$30,000-$34,999", "$35,000-$39,999", "$40,000-$44,999", "$45,000-$49,999", "$50,000-$54,999", "$55,000-$59,999", "$60,000-$64,999", "$65,000-$69,999", "$70,000-$74,999","$75,000-$79,999", "$80,000-$84,999", "$85,000-$89,999", "$90,000-$94,999", "$95,000-$99,999", "$100,000-$124,999", "$125,000-$149,999", "$150,000-$199,999", "$200,000-$249,000", "$250,000 or more", "Prefer not to answer")

# Convert the income column to a factor with the desired order
income$household_income <- factor(income$household_income, levels = income_order)

# Generate a bar chart with household_income on the x axis and count on the y axis, colored by opinion
ggplot(income, aes(x = household_income, y = ..count.., fill = single_use_utensil_bylaw_opinion)) +
  geom_bar(stat = "count", position = "dodge") +
  labs( 
       x = "Household Income", y = "Count", fill = "Opinion") +
  scale_fill_manual(values = c("#F8766D")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
From @fig-15, we observed that individuals who strongly oppose the single-use utensil bylaw are distributed across various household income levels. However, it is important to note that very few people with household incomes exceeding $199,999 hold this strongly opposing view.

This finding suggests that factors other than income may contribute to the strong opposition to the bylaw. These factors could include personal values, beliefs, or individual experiences that shape one's perspective on the issue. Additionally, this observation highlights that opposition to the bylaw is not limited to any particular income bracket and that efforts to address concerns and raise awareness should be inclusive and reach out to diverse segments of the population.




```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-16
#| fig-cap: "Don't know Opinions on Single-Use Utensil Bylaw by Household Income"
# Subset the data frame to include only the necessary columns and select only "Don't know" opinions
income <- subset(raw_data, select = c("single_use_utensil_bylaw_opinion", "household_income"))
income <- subset(income, single_use_utensil_bylaw_opinion == "Don't know")

# Convert the opinion column to a factor with the desired order
income$single_use_utensil_bylaw_opinion <- factor(income$single_use_utensil_bylaw_opinion, levels = opinion_order)

# Define the order of the income categories
income_order <- c("Less than $5,000", "$5,000-$9,999", "$10,000-$14,999", "$15,000-$19,999", "$20,000-$24,999", "$25,000-$29,999", "$30,000-$34,999", "$35,000-$39,999", "$40,000-$44,999", "$45,000-$49,999", "$50,000-$54,999", "$55,000-$59,999", "$60,000-$64,999", "$65,000-$69,999", "$70,000-$74,999","$75,000-$79,999", "$80,000-$84,999", "$85,000-$89,999", "$90,000-$94,999", "$95,000-$99,999", "$100,000-$124,999", "$125,000-$149,999", "$150,000-$199,999", "$200,000-$249,000", "$250,000 or more", "Prefer not to answer")

# Convert the income column to a factor with the desired order
income$household_income <- factor(income$household_income, levels = income_order)

# Generate a bar chart with household_income on the x axis and count on the y axis, colored by opinion
ggplot(income, aes(x = household_income, y = ..count.., fill = single_use_utensil_bylaw_opinion)) +
  geom_bar(stat = "count", position = "dodge") +
  labs(
       x = "Household Income", y = "Count", fill = "Opinion") +
  scale_fill_manual(values = c("#F8766D")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
In @fig-16, we observed that a significant number of respondents who selected "don't know" as their opinion on the single-use utensil bylaw also preferred not to disclose their household income. This finding suggests that this group of respondents may be less inclined to share personal information or are uncertain about their stance on the issue due to various reasons, such as lack of awareness or insufficient knowledge about the bylaw.


# Model
Our final logistic regression model is as follows:
$$log(\frac{\hat{p}_i}{\hat{p}_{ref}}) = \beta_{i0} + \beta_{i1}x_{gender} + \beta_{i2}x_{age} + \beta_{i3}x_{education} + \beta_{i4}x_{household_income}$$
The multinomial logistic regression model estimates the probability of a person's opinion on a by-request/ask-first bylaw aimed at reducing single-use eating utensil consumption in the City of Toronto. The possible opinions include: Strongly Support, Somewhat Support, Neither Support nor Oppose, Somewhat Oppose, Strongly Oppose, and Don't Know. The model takes into account the following 5 predictor variables:
                              
1) Age is a continuous numeric variable representing the individual's age.
                                        
2) Gender is a binary variable (female/male) indicating a person's gender.
                                                
3) Education is a categorical variable representing the highest level of education a respondent had at the time of taking the survey. Categories include Graduated from college/CEGEP/Trade School, Graduated high school, Primary school or less, Some college/CEGEP/Trade School, Some high school, Some university but did not finish, University graduate degree, and University undergraduate degree.
                                               
4) Household income is a categorical variable indicating the respondent's household income range. Categories encompass different income ranges and a "Prefer not to answer" option.
                                                     


# Results
                                          
```{r}
#| message: false
#| warning: false
#| echo: false
#| tbl-cap: "Number and Proportion of people opinion on a by-request / ask first bylaw to reduce the use of single-use eating utensils in the City of Toronto"
#| label: tbl-number

# generate count and percentage
result_table <- raw_data %>%
  group_by(`single_use_utensil_bylaw_opinion`) %>%
  summarise(count = n()) %>%
  mutate(percentage = count / sum(count) * 100) %>%
  as.data.frame()

# change the value "Don?t know" to "Don't know"
result_table$single_use_utensil_bylaw_opinion <- ifelse(result_table$single_use_utensil_bylaw_opinion == "Don?t know", "Don't know", result_table$single_use_utensil_bylaw_opinion)

# print the table
kable(result_table)
```
                              
@tbl-number presented summarizes the choices made by respondents regarding single-use takeaway items. The results indicate that 47.6% of respondents showed strong support for a by-request/ask-first bylaw to reduce the use of single-use eating utensils in the City of Toronto. Additionally, 27.9% of respondents somewhat supported the bylaw, while 11.4% of them neither supported nor opposed it. However, 6.2% of respondents somewhat opposed the bylaw, and 4.5% strongly opposed it. These findings suggest that while there is a significant level of support for the bylaw, there are still some concerns or reservations that need to be addressed.

Overall, the analysis suggests that there is mixed support for the single-use utensil bylaw, with a slight majority of respondents showing strong support for it. It is interesting to note that a significant percentage of respondents are still on the fence, as they neither support nor oppose the bylaw. This could indicate a lack of awareness or understanding of the issues surrounding single-use utensils and their impact on the environment.



```{r, include=FALSE}
# apply multinomial logistic regression model
model1 <- multinom(single_use_utensil_bylaw_opinion ~ age + gender + education + household_income, data = raw_data)

# extract the Residual Deviance and AIC values from the summary table
deviance <- round(model1$deviance, 3)
AIC <- round(AIC(model1), 3)

# Create a data frame with the Residual Deviance and AIC values
summary_data <- data.frame(`Residual Deviance` = deviance, `AIC` = AIC)

```

```{r}
#| message: false
#| warning: false
#| echo: false
#| tbl-cap: "Model Evaluation Metrics: Residual Deviance and Akaike Information Criterion (AIC)"
#| label: tbl-variance
# print the data
kable(t(summary_data), col.names = NULL, align = "c")
```

@tbl-variance shows that the logistic regression model has a statistically significant fit, as demonstrated by the significant difference between the null and residual deviance values. This suggests that the model has captured important information about the relationship between the predictors and the response variable. Furthermore, the AIC value of 2855.234 indicates that the model has some degree of complexity, but still performs reasonably well in terms of goodness-of-fit. These findings suggest that the model is a viable predictor of individual opinions towards a single-use utensil bylaw, based on their age, gender, education, and household income.

# Reference
